{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ahmed/Desktop/Fifth%20semester/blockchain/project/frontend/app/verify/page.js"],"sourcesContent":["\"use client\";\r\n\r\nimport { useRef, useState } from \"react\";\r\n\r\nexport default function VerifyPage() {\r\n  const [studentId, setStudentId] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  const [record, setRecord] = useState(null);\r\n  const [scannerActive, setScannerActive] = useState(false);\r\n  const videoRef = useRef(null);\r\n  const streamRef = useRef(null);\r\n  const rafRef = useRef(null);\r\n  const scannerEnabledRef = useRef(false);\r\n\r\n  async function verifyById(id) {\r\n    setLoading(true);\r\n    setError(\"\");\r\n    setRecord(null);\r\n\r\n    try {\r\n      const response = await fetch(\"/api/verify\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ studentId: id }),\r\n      });\r\n      const payload = await response.json();\r\n      if (!response.ok) {\r\n        throw new Error(payload.error || \"Verification failed\");\r\n      }\r\n      setRecord(payload);\r\n    } catch (requestError) {\r\n      setError(requestError.message || \"Unexpected error occurred\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function handleSubmit(event) {\r\n    event.preventDefault();\r\n    const id = studentId.trim();\r\n    if (!id) {\r\n      setError(\"Please enter student ID\");\r\n      return;\r\n    }\r\n    await verifyById(id);\r\n  }\r\n\r\n  function stopScanner() {\r\n    setScannerActive(false);\r\n    scannerEnabledRef.current = false;\r\n    if (rafRef.current) {\r\n      cancelAnimationFrame(rafRef.current);\r\n    }\r\n    if (streamRef.current) {\r\n      streamRef.current.getTracks().forEach((track) => track.stop());\r\n      streamRef.current = null;\r\n    }\r\n  }\r\n\r\n  async function startScanner() {\r\n    try {\r\n      if (!(\"BarcodeDetector\" in window)) {\r\n        throw new Error(\"QR scanner is not supported in this browser\");\r\n      }\r\n\r\n      const detector = new window.BarcodeDetector({ formats: [\"qr_code\"] });\r\n      const stream = await navigator.mediaDevices.getUserMedia({\r\n        video: { facingMode: \"environment\" },\r\n      });\r\n      streamRef.current = stream;\r\n      setScannerActive(true);\r\n      scannerEnabledRef.current = true;\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = stream;\r\n        await videoRef.current.play();\r\n      }\r\n\r\n      const scanLoop = async () => {\r\n        if (!videoRef.current || !scannerEnabledRef.current) {\r\n          return;\r\n        }\r\n        try {\r\n          const codes = await detector.detect(videoRef.current);\r\n          if (codes.length > 0) {\r\n            const rawValue = codes[0].rawValue || \"\";\r\n            const match = rawValue.match(/\\/verify\\/([^/?#]+)/);\r\n            const extractedId = match ? decodeURIComponent(match[1]) : rawValue;\r\n            setStudentId(extractedId);\r\n            stopScanner();\r\n            await verifyById(extractedId);\r\n            return;\r\n          }\r\n        } catch (_scanError) {\r\n          // ignore intermittent frame read errors\r\n        }\r\n        rafRef.current = requestAnimationFrame(scanLoop);\r\n      };\r\n\r\n      rafRef.current = requestAnimationFrame(scanLoop);\r\n    } catch (scannerError) {\r\n      setError(scannerError.message || \"Failed to start scanner\");\r\n      stopScanner();\r\n    }\r\n  }\r\n\r\n  const issueDate = record?.issueTimestamp\r\n    ? new Date(Number(record.issueTimestamp) * 1000).toLocaleString()\r\n    : null;\r\n\r\n  return (\r\n    <main style={{ maxWidth: 820, margin: \"0 auto\", display: \"grid\", gap: 12 }}>\r\n      <h1>Employer Verification</h1>\r\n      <form onSubmit={handleSubmit} style={{ display: \"grid\", gap: 8 }}>\r\n        <input\r\n          value={studentId}\r\n          onChange={(e) => setStudentId(e.target.value)}\r\n          placeholder=\"Enter Student ID\"\r\n          style={{ padding: \"0.6rem\" }}\r\n        />\r\n        <div style={{ display: \"flex\", gap: 8, flexWrap: \"wrap\" }}>\r\n          <button type=\"submit\" disabled={loading}>\r\n            {loading ? \"Verifying...\" : \"Verify\"}\r\n          </button>\r\n          {!scannerActive ? (\r\n            <button type=\"button\" onClick={startScanner}>\r\n              Scan QR\r\n            </button>\r\n          ) : (\r\n            <button type=\"button\" onClick={stopScanner}>\r\n              Stop Scanner\r\n            </button>\r\n          )}\r\n        </div>\r\n      </form>\r\n\r\n      {scannerActive ? (\r\n        <video ref={videoRef} style={{ width: \"100%\", maxWidth: 420, borderRadius: 8 }} muted />\r\n      ) : null}\r\n\r\n      {error ? <p style={{ color: \"crimson\" }}>{error}</p> : null}\r\n\r\n      {record ? (\r\n        <section style={{ border: \"1px solid #ddd\", borderRadius: 10, padding: \"1rem\" }}>\r\n          <p><strong>Name:</strong> {record.fullName || \"N/A\"}</p>\r\n          <p><strong>Program:</strong> {record.program || \"N/A\"}</p>\r\n          <p><strong>CGPA:</strong> {record.cgpa ?? \"N/A\"}</p>\r\n          <p><strong>Issuer:</strong> {record.issuer}</p>\r\n          <p><strong>Issue Date:</strong> {issueDate || \"N/A\"}</p>\r\n          <p><strong>Status:</strong> {record.isRevoked ? \"Revoked\" : \"Valid\"}</p>\r\n          <p>\r\n            <strong>Integrity Check:</strong>{\" \"}\r\n            {record.integrityValid ? \"Valid (hash matched)\" : \"Tampered (hash mismatch)\"}\r\n          </p>\r\n        </section>\r\n      ) : null}\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 362, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ahmed/Desktop/Fifth%20semester/blockchain/project/frontend/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,+KACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0]}}]
}