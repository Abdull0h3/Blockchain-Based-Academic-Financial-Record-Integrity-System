(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,82975,e=>{"use strict";var t=e.i(40025),r=e.i(42432);function n(){let[e,n]=(0,r.useState)(""),[s,i]=(0,r.useState)(!1),[a,c]=(0,r.useState)(""),[l,o]=(0,r.useState)(null),[u,d]=(0,r.useState)(!1),p=(0,r.useRef)(null),h=(0,r.useRef)(null),m=(0,r.useRef)(null),f=(0,r.useRef)(!1);async function g(e){i(!0),c(""),o(null);try{let t=await fetch("/api/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:e})}),r=await t.json();if(!t.ok)throw Error(r.error||"Verification failed");o(r.data)}catch(e){c(e.message||"Unexpected error occurred")}finally{i(!1)}}async function y(t){t.preventDefault();let r=e.trim();r?await g(r):c("Please enter student ID")}function x(){d(!1),f.current=!1,m.current&&cancelAnimationFrame(m.current),h.current&&(h.current.getTracks().forEach(e=>e.stop()),h.current=null)}async function j(){try{if(!("BarcodeDetector"in window))throw Error("QR scanner is not supported in this browser");let e=new window.BarcodeDetector({formats:["qr_code"]}),t=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});h.current=t,d(!0),f.current=!0,p.current&&(p.current.srcObject=t,await p.current.play());let r=async()=>{if(p.current&&f.current){try{let t=await e.detect(p.current);if(t.length>0){let e=t[0].rawValue||"",r=e.match(/\/verify\/([^/?#]+)/),s=r?decodeURIComponent(r[1]):e;n(s),x(),await g(s);return}}catch(e){}m.current=requestAnimationFrame(r)}};m.current=requestAnimationFrame(r)}catch(e){c(e.message||"Failed to start scanner"),x()}}let w=l?.issueDate?new Date(l.issueDate).toLocaleString():l?.timestamp?new Date(1e3*Number(l.timestamp)).toLocaleString():null;return(0,t.jsxs)("main",{style:{maxWidth:820,margin:"0 auto",display:"grid",gap:12},children:[(0,t.jsx)("h1",{children:"Employer Verification"}),(0,t.jsxs)("form",{onSubmit:y,style:{display:"grid",gap:8},children:[(0,t.jsx)("input",{value:e,onChange:e=>n(e.target.value),placeholder:"Enter Student ID",style:{padding:"0.6rem"}}),(0,t.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,t.jsx)("button",{type:"submit",disabled:s,children:s?"Verifying...":"Verify"}),u?(0,t.jsx)("button",{type:"button",onClick:x,children:"Stop Scanner"}):(0,t.jsx)("button",{type:"button",onClick:j,children:"Scan QR"})]})]}),u?(0,t.jsx)("video",{ref:p,style:{width:"100%",maxWidth:420,borderRadius:8},muted:!0}):null,a?(0,t.jsx)("p",{style:{color:"crimson"},children:a}):null,l?(0,t.jsxs)("section",{style:{border:"1px solid #ddd",borderRadius:10,padding:"1rem"},children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Name:"})," ",l.fullName||"N/A"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Program:"})," ",l.program||"N/A"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"CGPA:"})," ",l.cgpa??"N/A"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Issuer:"})," ",l.issuer]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Issue Date:"})," ",w||"N/A"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Status:"})," ",l.status||(l.isValid?"Valid":"Revoked")]})]}):null]})}e.s(["default",()=>n])}]);